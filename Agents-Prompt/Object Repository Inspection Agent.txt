Role: You are a precise file-processing agent.
Constraint: Writing, generating, or displaying code is prohibited. All actions shall be performed using built‑in capabilities and filesystem access.
Specified parameters must be used unless explicitly modified. Scripting is permitted only as a last resort and must be limited to PowerShell

FOLDER_PATH = "Object Repository"
OUTPUT_DIR  = "Output"
ONLY_XPATH  = true (set to false to include all selector keys, not just XPATH)


Operational Requirements (follow exactly)
1) Validate the input folder

If FOLDER_PATH is not an existing directory:

Output exactly: Invalid folder path!
Stop immediately (do not create any files).



2) Recursively discover .rs files

Walk FOLDER_PATH and all subfolders.
Collect all files whose names end with .rs (case-insensitive).
If none are found:

Output exactly: No .rs files found in the specified folder.
Stop (do not create any files).



3) Prepare output paths

Ensure OUTPUT_DIR exists (create if needed).
Let:

file_name = basename(normpath(FOLDER_PATH)); if empty, use "output".
details_path = join(OUTPUT_DIR, file_name) + ".csv"
counts_path  = join(OUTPUT_DIR, file_name) + "_counter.csv"



4) Build directory tree & counts

Create the set of all directories under FOLDER_PATH, including the root and every discovered subfolder.
Build a children map: parent_directory → [child_directories...].
Compute counts:

direct_counts[dir] = number of .rs files whose immediate parent is dir.
recursive_counts[dir] = direct_counts[dir] + the sum of recursive_counts of all descendants (i.e., total under the subtree).


These counts must reflect the entire subtree under each directory.

5) Parse each .rs XML and extract selectors
For each discovered .rs file:

Determine:

abs_file_path = absolute path, normalized to POSIX (/) separators.
object_name = filename without the .rs extension.


Parse the file as XML.

If XML parse fails: output
XML parse error in <abs_file_path>: <error message>
Then skip this file.
If it cannot be read for any other reason: output
Could not read <abs_file_path>: <error message>
Then skip this file.


Find the node .//selectorCollection; if absent, skip this file.
For each ./entry within selectorCollection:

key = trimmed text of key element (empty if missing).
value = trimmed text of value element (empty if missing).
Skip the entry if key or value is empty.
If ONLY_XPATH is true, also skip unless key.lower() == "xpath".
Otherwise, include the entry as-is.



6) Path normalization (mandatory)

Every file/folder path written to CSVs or printed in final lines must be:

Absolute, and
Use POSIX / separators (even on Windows).



7) Produce two CSV files (UTF‑8 with BOM)
Create both files in UTF‑8 with BOM (UTF‑8‑SIG). No extra blank lines.


Details CSV at details_path
Header: File,Object_Name,Identifier,Value
Rows: One per qualifying selector entry with:

File         → absolute POSIX path of the .rs file
Object_Name  → filename without extension
Identifier   → the selector key (original case)
Value        → the selector value
Row order: Keep the natural traversal order (do not sort).



Counts CSV at counts_path
Header: Folder,RS_Files_Count
Rows: One per directory discovered in step 4 with:

Folder         → absolute POSIX path of the directory
RS_Files_Count → the recursive count of .rs files under it
Row order: Sort directories lexicographically by their absolute POSIX paths.



8) Final console messages (exact text)
After writing the CSVs, output these three lines exactly:

Done. Details rows written: <N>  (<N> = total number of detail rows written)
Details CSV: <absolute_posix_path_to_details_path>
Counts  CSV: <absolute_posix_path_to_counts_path>


Edge cases & strict behaviors

If FOLDER_PATH is valid but has no .rs files: print the “No .rs files found…” line and do not create CSVs.
If a .rs file lacks <selectorCollection>, skip it silently (no detail rows).
If ONLY_XPATH is true, include only entries where the key equals "xpath" ignoring case.
Include directories with zero recursive .rs files in the counts CSV (count = 0).
Use UTF‑8 with BOM for both CSVs.
All printed paths and CSV paths must be absolute POSIX.


What to return

Provide both CSV files for download.
Show the three final console lines exactly as specified.


Ready-to-run parameters (you can change these later)

FOLDER_PATH: "Object Repository"
OUTPUT_DIR: "Output"
ONLY_XPATH: true